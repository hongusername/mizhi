<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="cn.jishu.mizhi.kai.manager.dao.ManagerDao">
   <!--
   List<Users> queryAllUser();
    Users qeuryUsersById(@Param("userId") Integer userid);
    Integer updateUserStatus(@Param("updateUser") Users users);
    List<Questions> qeuryAllQuestions();
    List<Questionstype> queyrTypeById(@Param("qId") Integer questId);
    Integer updateStatus(@Param("updateId") Integer questionId);

    List<           > queryAll();
    Integer deleteByQuestionId(@Param("mid") Integer mid);
    Integer insertMember(@Param("member") Member member);
    Integer updateMember(@Param("upMember")Member member);-->
    <select id="queryAllUser" resultType="cn.jishu.mizhi.entity.Users">
        select * from users
    </select>
    <select id="qeuryUsersById" resultType="cn.jishu.mizhi.entity.Users">
        select * from users where userid=#{userId}
    </select>
    <update id="updateUserStatus" parameterType="cn.jishu.mizhi.entity.Users">
        update users set ustatus=#{updateUser.ustatus} where userid=#{updateUser.userid}
    </update>
    <resultMap id="QuestionMapUser" type="cn.jishu.mizhi.entity.Questions" autoMapping="true">
        <id column="qid" property="qid"></id>
        <association property="users" resultMap="UserMapQ"></association>
    </resultMap>
    <resultMap id="UserMapQ" type="cn.jishu.mizhi.entity.Users" autoMapping="true">
        <id column="userid" property="userid"></id>
    </resultMap>
    <select id="qeuryAllQuestions" resultMap="QuestionMapUser">
        select * from questions
    </select>


    <resultMap id="QuestionMap" type="cn.jishu.mizhi.entity.Questions" autoMapping="true">
        <id column="qid" property="qid"></id>
        <result column="qtitle" property="qtitle"></result>
        <result column="qcontent" property="qcontent"></result>
        <result column="clickcount" property="clickcount"></result>
        <result column="questionstatus" property="questionstatus"></result>
        <result column="qtime" property="qtime"></result>
        <collection property="questionstypes" resultMap="questionstypesMap"></collection>
        <collection property="questionscontextList" resultMap="QuestionContextMap"></collection>
    </resultMap>

    <resultMap id="questionstypesMap" type="cn.jishu.mizhi.entity.Questionstype" autoMapping="true" >
        <id column="qtid" property="qtid"></id>
        <result property="qtname" column="qtname"></result>
    </resultMap>
    <resultMap id="QuestionContextMap" type="cn.jishu.mizhi.entity.Questionscontext" autoMapping="true">
        <id property="qcid" column="qcid"></id>
    </resultMap>


    <select id="queyrTypeById" resultMap="QuestionMap" >
        select * from questionstype INNER JOIN questionscontext on questionscontext.qtid=questionstype.qtid INNER JOIN questions on questions.qid=#{qId} and questions.qid=questionscontext.qid
    </select>

    <update id="updateStatus" parameterType="cn.jishu.mizhi.entity.Questions">
        update questions set questionstatus=#{updateId.questionstatus} where qid=#{updateId.qid}
    </update>
    <select id="queryAll" resultType="cn.jishu.mizhi.entity.Member">
        select * from member
    </select>
    <delete id="deleteByQuestionId">
        delete from member where mid=#{mid}
    </delete>


    <insert id="insertMember" parameterType="cn.jishu.mizhi.entity.Member">
        INSERT INTO member values(null,#{member.mlevel},#{member.downloadcount},#{member.scores},#{member.mprice},#{member.discount})
    </insert>

  <update id="updateMember" parameterType="cn.jishu.mizhi.entity.Member">
        UPDATE member SET mlevel=#{upMember.mlevel},downloadcount=#{upMember.downloadcount},scores=#{upMember.scores},mprice=#{upMember.mprice},discount=#{upMember.discount} WHERE MID=#{upMember.mid}
    </update>
    <select id="queryByMemberById" resultType="cn.jishu.mizhi.entity.Member">
        select * from member where mid=#{qMid}
    </select>



</mapper>